#set par(justify: true)
#set page(flipped: true)

#align(center)[
  #text(size: 20pt, weight: "bold", )[Przetwarzanie dużych zbiorów danych (PDZD)]

  Zespół B1 (geopolityka i muzyka): \
  *Tomasz Chojnacki (260365), Kamila Iwańska (253027), Jakub Zehner (260285)*
]

= Zadanie 4 -- Procesy przetwarzania danych

*Wszystkie obliczenia i pliki tymczasowe zostały opisane pod diagramem.*

#image("pdzd.drawio.svg", width: 100%)

== `charts_fmt`

=== Obliczenia

- filtrowanie `chart == "top200"`
- obliczenie `track_id = url[len("https://open.spotify.com/track/"):]`

=== Plik tymczasowy

Rozmiar: \~400 MB

```
┌────────────┬────────────────────────┬───────────┬─────────┐
│    date    │        track_id        │  region   │ streams │
│    date    │        varchar         │  varchar  │  int64  │
├────────────┼────────────────────────┼───────────┼─────────┤
│ 2017-01-01 │ 6mICuAdrwEjh6Y6lroV2Kg │ Argentina │  253019 │
│ 2017-01-01 │ 7DM4BPaS7uofFul3ywMe46 │ Argentina │  223988 │
│ 2017-01-01 │ 3AEZUABDXNtecAOSC1qTfo │ Argentina │  210943 │
│ 2017-01-01 │ 6rQSrBHf7HlZjtcMZ4S4bO │ Argentina │  173865 │
│ 2017-01-01 │ 58IL315gMSTD37DOZPJ2hf │ Argentina │  153956 │
│ 2017-01-01 │ 5J1c3M4EldCfNxXwrwt8mT │ Argentina │  151140 │
│ 2017-01-01 │ 1MpKZi1zTXpERKwxmOu1PH │ Argentina │  148369 │
│ 2017-01-01 │ 3QwBODjSEzelZyVjxPOHdq │ Argentina │  143004 │
│ 2017-01-01 │ 0sXvAOmXgjR2QUqLK1MltU │ Argentina │  126389 │
│ 2017-01-01 │ 20ZAJdsKB5IGbGj4ilRt2o │ Argentina │  112012 │
...
└────────────┴────────────────────────┴───────────┴─────────┘
```

== `charts_daily_sum`

=== Obliczenia

- grupowanie `region`, `date`
- agregacja `streams` (suma)

=== Plik tymczasowy

Rozmiar: \~1 MB

```
┌───────────┬────────────┬──────────┐
│  region   │    date    │ streams  │
│  varchar  │    date    │  int128  │
├───────────┼────────────┼──────────┤
│ Argentina │ 2017-01-01 │  7888872 │
│ Argentina │ 2017-01-02 │  6010041 │
│ Argentina │ 2017-01-03 │  5921907 │
│ Argentina │ 2017-01-04 │  6019573 │
│ Argentina │ 2017-01-05 │  6223646 │
│ Argentina │ 2017-01-06 │  6485179 │
│ Argentina │ 2017-01-07 │  6840811 │
│ Argentina │ 2017-01-08 │  5691182 │
│ Argentina │ 2017-01-09 │  5880184 │
│ Argentina │ 2017-01-10 │  5896533 │
...
└───────────────────────────────────┘
```

== `charts_yearly_stats`

=== Obliczenia

- obliczenie `year = year(date)`
- grupowanie `region`, `year`
- agregacja `streams` (średnia, odchylenie standardowe)

=== Plik tymczasowy

Rozmiar: \<1 MB

```
┌───────────┬────────────┬────────────┬───────────────────┬────────────────────┐
│  region   │    date    │  streams   │    stream_avg     │     stream_dev     │
│  varchar  │    date    │   double   │      double       │       double       │
├───────────┼────────────┼────────────┼───────────────────┼────────────────────┤
│ Argentina │ 2017-01-01 │  7888872.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-02 │  6010041.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-03 │  5921907.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-04 │  6019573.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-05 │  6223646.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-06 │  6485179.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-07 │  6840811.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-08 │  5691182.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-09 │  5880184.0 │ 7424229.113259668 │ 1034041.7027895374 │
│ Argentina │ 2017-01-10 │  5896533.0 │ 7424229.113259668 │ 1034041.7027895374 │
...
└──────────────────────────────────────────────────────────────────────────────┘
```

== `charts_daily_popularity`

=== Obliczenia

- złączenie `charts_daily_sum d` i `charts_yearly_stats y` \ na `year(d.date) == y.year && d.region == y.region`
- obliczenie `stream_std = (d.streams - y.stream_avg) / y.stream_dev`
- obliczenie `popularity =`
  - `"VERY LOW"` jeśli `stream_std < -1.5`
  - `"LOW"` jeśli `-1.5 <= stream_std < -0.5`
  - `"AVERAGE"` jeśli `-0.5 <= stream_std <= 0.5`
  - `"HIGH"` jeśli `0.5 < stream_std <= 1.5`
  - `"VERY HIGH"` jeśli `stream_std > 1.5`

=== Plik tymczasowy

Rozmiar: \<1 MB

```
┌───────────┬────────────┬────────────┐
│  region   │    date    │ popularity │
│  varchar  │    date    │  varchar   │
├───────────┼────────────┼────────────┤
│ Argentina │ 2017-01-01 │ AVERAGE    │
│ Argentina │ 2017-01-02 │ LOW        │
│ Argentina │ 2017-01-03 │ LOW        │
│ Argentina │ 2017-01-04 │ LOW        │
│ Argentina │ 2017-01-05 │ LOW        │
│ Argentina │ 2017-01-06 │ LOW        │
│ Argentina │ 2017-01-07 │ LOW        │
│ Argentina │ 2017-01-08 │ VERY LOW   │
│ Argentina │ 2017-01-09 │ LOW        │
│ Argentina │ 2017-01-10 │ LOW        │
...
└─────────────────────────────────────┘
```

== `daily_country_weather`

=== Obliczenia

- filtrowanie `date >= "2017-01-01" && date <= "2021-12-31"`
- złączenie `daily_weather w` i `cities c` \ na `w.station_id == c.station_id`
- grupowanie `country`, `date`
- agregacja `temperature_c` (średnia), `precipitation_mm` (średnia)
- obliczenie `precipitation_mm = 0.0` jeśli `precipitation_mm == null`
- filtrowanie `temperature_c != null`

=== Plik tymczasowy

Rozmiar: \~2 MB

```
┌─────────────┬────────────┬──────────────────────┬──────────────────┐
│   country   │    date    │    temperature_c     │ precipitation_mm │
│   varchar   │    date    │        double        │      double      │
├─────────────┼────────────┼──────────────────────┼──────────────────┤
│ Afghanistan │ 2017-01-01 │   5.3166666666666655 │              0.0 │
│ Afghanistan │ 2017-01-02 │    5.016666666666667 │              2.0 │
│ Afghanistan │ 2017-01-03 │   3.0666666666666664 │           10.725 │
│ Afghanistan │ 2017-01-04 │                 2.65 │            109.0 │
│ Afghanistan │ 2017-01-05 │   1.9333333333333333 │            29.95 │
│ Afghanistan │ 2017-01-06 │   0.9833333333333331 │             7.25 │
│ Afghanistan │ 2017-01-07 │   0.2833333333333334 │             33.0 │
│ Afghanistan │ 2017-01-08 │ -0.07999999999999999 │             18.0 │
│ Afghanistan │ 2017-01-09 │ -0.21666666666666665 │              0.0 │
│ Afghanistan │ 2017-01-10 │    0.866666666666667 │              0.0 │
...
└────────────────────────────────────────────────────────────────────┘
```

== `wdi_normalized`

=== Obliczenia

- filtrowanie `code in ('SP.RUR.TOTL.ZS', 'SP.DYN.TFRT.IN', 'NY.GDP.PCAP.CD', 'IT.CEL.SETS.P2', 'SM.POP.REFG', 'SP.POP.TOTL')`
- projekcja `country`, `code`, `2016` `2017`, `2018`, `2019`, `2020`, `2021`
- unpivotowanie `2016`, `2017`, `2018`, `2019`, `2020`, `2021` na `year`, `value`
- pivotowanie `country`, `year`, `code`, `value` na `country`, `year`, `country`, `year`, `rural_population_percent`, `fertility_rate`, `gdp_per_capita_usd`, `mobile_subscriptions_per_100`, `refugee_population`, `total_population`
- obliczenie `refugee_population_promille = refugee_population / total_population * 1000`

=== Plik tymczasowy

Rozmiar: \<1 MB

#[
#set text(size: 8.7pt)
```
┌─────────────────────────────┬───────┬──────────────────────────┬──────────────────┬────────────────────┬──────────────────────────────┬─────────────────────────────┐
│           country           │ year  │ rural_population_percent │  fertility_rate  │ gdp_per_capita_usd │ mobile_subscriptions_per_100 │ refugee_population_promille │
│           varchar           │ int32 │          double          │      double      │       double       │            double            │           double            │
├─────────────────────────────┼───────┼──────────────────────────┼──────────────────┼────────────────────┼──────────────────────────────┼─────────────────────────────┤
│ Afghanistan                 │  2016 │                    74.75 │            5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan                 │  2017 │                    74.75 │            5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan                 │  2018 │                   74.505 │            5.002 │   502.056770622973 │                  59.90264778 │          1.9687743684483217 │
│ Afghanistan                 │  2019 │                   74.246 │             4.87 │   500.522664145294 │                  59.78387904 │          1.9123102480125564 │
│ Afghanistan                 │  2020 │                   73.974 │             4.75 │   516.866552182696 │                   58.1902139 │          1.8546026234577802 │
│ Afghanistan                 │  2021 │                   73.686 │            4.643 │   368.754614175459 │                  56.55443457 │           1.669573521958973 │
...
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
]

== `wdi_interpolated`

=== Obliczenia

- generowanie serii dat `d` od `2017-01-01` do `2021-12-31`
- złączenie dat z `wdi_normalized nxt` na `year(d.date) == nxt.year`
- złączenie dat z `wdi_normalized prv` na `year(d.date) - 1 == prv.year && prv.country == nxt.country`
- obliczenie interpolacji liniowej dla `rural_population_percent`, `fertility_rate`, `gdp_per_capita_usd`, `mobile_subscriptions_per_100`, `refugee_population_promille`:
  - `value = prv.value * (1 - (d.dayofyear / 365)) + nxt.value * (d.dayofyear / 365)`

=== Plik tymczasowy

Rozmiar: \~15 MB

#[
#set text(size: 9.2pt)
```
┌─────────────┬────────────┬──────────────────────────┬────────────────────┬────────────────────┬──────────────────────────────┬─────────────────────────────┐
│   country   │    date    │ rural_population_percent │   fertility_rate   │ gdp_per_capita_usd │ mobile_subscriptions_per_100 │ refugee_population_promille │
│   varchar   │    date    │          double          │       double       │       double       │            double            │           double            │
├─────────────┼────────────┼──────────────────────────┼────────────────────┼────────────────────┼──────────────────────────────┼─────────────────────────────┤
│ Afghanistan │ 2017-01-01 │                    74.75 │              5.129 │   530.149830802984 │            67.13641492000002 │           2.130182913434396 │
│ Afghanistan │ 2017-01-02 │                    74.75 │              5.129 │  530.1498308029841 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan │ 2017-01-03 │                    74.75 │              5.129 │   530.149830802984 │            67.13641492000002 │           2.130182913434396 │
│ Afghanistan │ 2017-01-04 │                    74.75 │              5.129 │   530.149830802984 │                  67.13641492 │          2.1301829134343966 │
│ Afghanistan │ 2017-01-05 │                    74.75 │              5.129 │  530.1498308029838 │                  67.13641492 │          2.1301829134343957 │
│ Afghanistan │ 2017-01-06 │                    74.75 │              5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan │ 2017-01-07 │                    74.75 │              5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan │ 2017-01-08 │                    74.75 │              5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan │ 2017-01-09 │                    74.75 │              5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
│ Afghanistan │ 2017-01-10 │                    74.75 │              5.129 │   530.149830802984 │                  67.13641492 │           2.130182913434396 │
...
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

]

== `charts_artists`

=== Obliczenia

- pobranie `artist_id` dla `track_id` z API Spotify

=== Plik tymczasowy

Rozmiar: \~500 MB

```
┌────────────────────┬────────────┬──────────────────────────────────┬─────────┐
│       region       │    date    │            artist_id             │ streams │
│      varchar       │    date    │             varchar              │  int64  │
├────────────────────┼────────────┼──────────────────────────────────┼─────────┤
│ France             │ 2018-02-05 │ b9eefc7c45f930c7e35dc9e8d1f0c03b │   56509 │
│ France             │ 2018-02-05 │ 74b8ef2f62a8382d8b739d77eaa70933 │   55302 │
│ France             │ 2018-02-05 │ 1452d7dd96804b329fdc1975472c0ca5 │   54797 │
│ France             │ 2018-02-05 │ 32a0462c8557fd7ebbd4bdb72409c45a │   53970 │
│ France             │ 2018-02-05 │ dc9d9e4ae29f85418cb2c6036f46ac87 │   52859 │
│ France             │ 2018-02-05 │ 84bb4ff9bfc07c6611685fcc513eb6b4 │   52540 │
│ France             │ 2018-02-05 │ 7b1f9ae869f3817cf63fef5740433b48 │   52074 │
│ France             │ 2018-02-05 │ 5e3ab178adebf76b71d0fb5994a301f5 │   51916 │
│ France             │ 2018-02-05 │ c19162e3de8a97b9e8110ade142cd7c4 │   51530 │
│ France             │ 2018-02-05 │ e6aca965bae0a963405c44252802af59 │   50620 │
...
└──────────────────────────────────────────────────────────────────────────────┘
```

== `charts_genres`

=== Obliczenia

- pobranie `genre` dla `artist_id` z API Spotify

=== Plik tymczasowy

Rozmiar: \~400 MB

```
┌────────────────┬────────────┬─────────────────────────┬─────────┐
│     region     │    date    │          genre          │ streams │
│    varchar     │    date    │         varchar         │  int64  │
├────────────────┼────────────┼─────────────────────────┼─────────┤
│ France         │ 2018-02-05 │ trap latino             │   56509 │
│ France         │ 2018-02-05 │ uk pop                  │   55302 │
│ France         │ 2018-02-05 │ french hip hop          │   54797 │
│ France         │ 2018-02-05 │ old school rap francais │   53970 │
│ France         │ 2018-02-05 │ edm                     │   52859 │
│ France         │ 2018-02-05 │ rock                    │   52540 │
│ France         │ 2018-02-05 │ post-teen pop           │   52074 │
│ France         │ 2018-02-05 │ old school rap francais │   51916 │
│ France         │ 2018-02-05 │ uk pop                  │   51530 │
│ France         │ 2018-02-05 │ french pop              │   50620 │
...
└─────────────────────────────────────────────────────────────────┘
```

== `charts_daily_genres`

=== Obliczenia

- filtrowanie `genre in ('pop', 'rap', 'rock', 'edm', 'hip hop', 'trap latino', 'reggaeton', 'electropop', 'dance pop', 'pop rap', 'musica mexicana', 'trap', 'modern rock', 'classic rock', 'uk pop', 'k-pop', 'tropical house', 'melodic rap', 'canadian pop', 'modern bollywood')`
- grupowanie `region`, `date`, `genre`
- agregacja `streams` (suma)
- pivotowanie `region`, `date`, `genre`, `total_streams` na `region`, `date`, `pop`, `rap`, `rock`, `edm`, `hip hop`, `trap latino`, `reggaeton`, `electropop`, `dance pop`, `pop rap`, `musica mexicana`, `trap`, `modern rock`, `classic rock`, `uk pop`, `k-pop`, `tropical house`, `melodic rap`, `canadian pop`, `modern bollywood`

=== Plik tymczasowy

Rozmiar: \~10 MB

#[
#set text(size: 5.3pt)
```
┌───────────┬────────────┬─────────┬────────┬────────┬────────┬─────────┬─────────────┬───────────┬────────────┬───────────┬─────────┬─────────────────┬────────┬─────────────┬──────────────┬─────────┬────────┬────────────────┬─────────────┬──────────────┬──────────────────┐
│  region   │    date    │   pop   │  rap   │  rock  │  edm   │ hip_hop │ trap_latino │ reggaeton │ electropop │ dance_pop │ pop_rap │ musica_mexicana │  trap  │ modern_rock │ classic_rock │ uk_pop  │ k_pop  │ tropical_house │ melodic_rap │ canadian_pop │ modern_bollywood │
│  varchar  │    date    │ int128  │ int128 │ int128 │ int128 │ int128  │   int128    │  int128   │   int128   │  int128   │ int128  │     int128      │ int128 │   int128    │    int128    │ int128  │ int128 │     int128     │   int128    │    int128    │      int128      │
├───────────┼────────────┼─────────┼────────┼────────┼────────┼─────────┼─────────────┼───────────┼────────────┼───────────┼─────────┼─────────────────┼────────┼─────────────┼──────────────┼─────────┼────────┼────────────────┼─────────────┼──────────────┼──────────────────┤
│ Argentina │ 2017-01-01 │ 1092346 │ 406152 │  58194 │ 498779 │  384572 │     2561509 │   2860676 │     161859 │   1434536 │  605275 │               0 │  46032 │       58194 │            0 │  272534 │      0 │         287511 │           0 │       401484 │                0 │
│ Argentina │ 2017-01-02 │ 1120185 │ 350652 │  65284 │ 473179 │  325933 │     2038126 │   2265312 │     175569 │   1192096 │  497748 │               0 │  59470 │       65284 │            0 │  328297 │      0 │         285278 │       14454 │       376746 │                0 │
│ Argentina │ 2017-01-03 │ 1125108 │ 343195 │  64927 │ 485874 │  316478 │     1981032 │   2215870 │     191624 │   1184483 │  493673 │               0 │  58841 │       64927 │            0 │  346667 │      0 │         301853 │       14066 │       366111 │                0 │
│ Argentina │ 2017-01-04 │ 1175079 │ 353022 │  63604 │ 517075 │  318541 │     1994011 │   2220783 │     219278 │   1265234 │  507188 │               0 │  51108 │       63604 │            0 │  346247 │      0 │         330316 │       13869 │       358781 │                0 │
│ Argentina │ 2017-01-05 │ 1198952 │ 360526 │  66545 │ 548225 │  316412 │     2039979 │   2302586 │     217451 │   1307859 │  531318 │               0 │  48468 │       66545 │            0 │  362467 │      0 │         348824 │       14129 │       348781 │                0 │
│ Argentina │ 2017-01-06 │ 1321016 │ 362649 │  66431 │ 568466 │  317132 │     2107927 │   2382989 │     216368 │   1316882 │  536704 │               0 │  46874 │       66431 │            0 │  474042 │      0 │         365175 │       14572 │       348572 │                0 │
│ Argentina │ 2017-01-07 │ 1223928 │ 354930 │  63391 │ 561204 │  319183 │     2225575 │   2490939 │     219131 │   1306887 │  533614 │               0 │  32569 │       63391 │            0 │  441259 │      0 │         357014 │       13666 │       328092 │                0 │
│ Argentina │ 2017-01-08 │ 1004465 │ 290497 │  55342 │ 455950 │  261865 │     1874413 │   2115345 │     176743 │   1049257 │  442864 │               0 │  26993 │       55342 │            0 │  364556 │      0 │         287436 │       11613 │       265027 │                0 │
│ Argentina │ 2017-01-09 │ 1222993 │ 316863 │  63627 │ 535792 │  282498 │     1878890 │   2125606 │     206488 │   1211454 │  491904 │               0 │  31556 │       63627 │            0 │  435340 │      0 │         342854 │       13939 │       316537 │                0 │
│ Argentina │ 2017-01-10 │ 1203696 │ 317411 │  62189 │ 531305 │  282473 │     1874319 │   2122219 │     209709 │   1211399 │  495559 │               0 │  30481 │       62189 │            0 │  433272 │      0 │         335772 │       13000 │       318454 │                0 │
...
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
]

== `charts_genre_popularity`

=== Obliczenia

- złączenie `charts_daily_genres g` i `charts_daily_sum s` \ na `g.region == s.region && g.date == s.date`
- obliczenie:
  - `pop = g.pop / s.streams`
  - `rap = g.rap / s.streams`
  - `rock = g.rock / s.streams`
  - `edm = g.edm / s.streams`
  - `hip_hop = g.hip_hop / s.streams`
  - `trap_latino = g.trap_latino / s.streams`
  - `reggaeton = g.reggaeton / s.streams`
  - `electropop = g.electropop / s.streams`
  - `dance_pop = g.dance_pop / s.streams`
  - `pop_rap = g.pop_rap / s.streams`
  - `musica_mexicana = g.musica_mexicana / s.streams`
  - `trap = g.trap / s.streams`
  - `modern_rock = g.modern_rock / s.streams`
  - `classic_rock = g.classic_rock / s.streams`
  - `uk_pop = g.uk_pop / s.streams`
  - `k_pop = g.k_pop / s.streams`
  - `tropical_house = g.tropical_house / s.streams`
  - `melodic_rap = g.melodic_rap / s.streams`
  - `canadian_pop = g.canadian_pop / s.streams`
  - `modern_bollywood = g.modern_bollywood / s.streams`

=== Plik tymczasowy

Rozmiar: \~15 MB

#[
#set text(size: 3pt)
```
┌───────────┬────────────┬─────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬─────────────────┬───────────────────────┬───────────────────────┬───────────────────────┬──────────────────────┬───────────────────────┬──────────────────────┬───────────────────────┬──────────────────────┬──────────────────┐
│  region   │    date    │         pop         │         rap          │         rock         │         edm          │       hip_hop        │     trap_latino      │      reggaeton       │      electropop      │      dance_pop       │       pop_rap        │ musica_mexicana │         trap          │      modern_rock      │     classic_rock      │        uk_pop        │         k_pop         │    tropical_house    │      melodic_rap      │     canadian_pop     │ modern_bollywood │
│  varchar  │    date    │       double        │        double        │        double        │        double        │        double        │        double        │        double        │        double        │        double        │        double        │     double      │        double         │        double         │        double         │        double        │        double         │        double        │        double         │        double        │      double      │
├───────────┼────────────┼─────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼─────────────────┼───────────────────────┼───────────────────────┼───────────────────────┼──────────────────────┼───────────────────────┼──────────────────────┼───────────────────────┼──────────────────────┼──────────────────┤
│ Argentina │ 2017-01-01 │  0.1384666908019296 │ 0.051484166557652346 │ 0.007376720017766798 │  0.06322564239855838 │  0.04874866774362672 │   0.3246990190739563 │  0.36262167772528187 │ 0.020517381952705027 │  0.18184298084694492 │  0.07672516425668968 │             0.0 │  0.005835054745469314 │  0.007376720017766798 │                   0.0 │ 0.034546637339279936 │                   0.0 │  0.03644513436141441 │                   0.0 │  0.05089244698101326 │              0.0 │
│ Argentina │ 2017-01-02 │ 0.18638558372563516 │  0.05834436071234789 │ 0.010862488292509152 │  0.07873140965261302 │  0.05423141040135999 │   0.3391201490971526 │   0.3769212223344233 │ 0.029212612692658835 │  0.19835072672549156 │  0.08281940173120284 │             0.0 │  0.009895107204759501 │  0.010862488292509152 │                   0.0 │  0.05462475214395376 │                   0.0 │  0.04746689748039989 │  0.002404975273879163 │   0.0626860948203182 │              0.0 │
│ Argentina │ 2017-01-03 │  0.1899908255904728 │  0.05795345992431154 │  0.01096386687599113 │  0.08204688118202465 │  0.05344190646695397 │   0.3345260234583218 │  0.37418183027865853 │  0.03235849532929173 │  0.20001715663552297 │    0.083363855595841 │             0.0 │  0.009936157389840806 │   0.01096386687599113 │                   0.0 │  0.05853975754769536 │                   0.0 │  0.05097226282006793 │ 0.0023752483786050674 │  0.06182315933026304 │              0.0 │
│ Argentina │ 2017-01-04 │  0.1952096934450334 │ 0.058645687991490426 │ 0.010566197967862505 │   0.0858989499753554 │  0.05291754082889268 │   0.3312545590858355 │  0.36892699864259476 │  0.03642750075462163 │   0.2101866693866824 │  0.08425647467021331 │             0.0 │  0.008490303215859332 │  0.010566197967862505 │                   0.0 │  0.05752019287746822 │                   0.0 │  0.05487365964330028 │ 0.0023039840201290024 │  0.05960240036959432 │              0.0 │
│ Argentina │ 2017-01-05 │ 0.19264463306556961 │ 0.057928423306852606 │ 0.010692285518810036 │  0.08808743299345753 │  0.05084029522244678 │   0.3277787650518683 │  0.36997380635081106 │  0.03493948723947345 │   0.2101435396550511 │  0.08537085817541679 │             0.0 │  0.007787718003241187 │  0.010692285518810036 │                   0.0 │  0.05824029837172615 │                   0.0 │  0.05604817497653305 │ 0.0022702126695509353 │  0.05604126584320509 │              0.0 │
│ Argentina │ 2017-01-06 │  0.2036976928470286 │  0.05591965927231924 │ 0.010243510626306537 │  0.08765617726203086 │  0.04890104035678892 │   0.3250375972660122 │  0.36745153834612737 │  0.03336345843345265 │  0.20306023935499698 │  0.08275854837622831 │             0.0 │  0.007227865260157044 │  0.010243510626306537 │                   0.0 │   0.0730962090637745 │                   0.0 │  0.05630916278486685 │ 0.0022469695901994376 │  0.05374901756759528 │              0.0 │
│ Argentina │ 2017-01-07 │  0.1789156285709399 │  0.05188419911031017 │ 0.009266591344213428 │  0.08203764144339026 │ 0.046658649098769135 │   0.3253378875691786 │   0.3641291946232691 │ 0.032032897853777866 │  0.19104269946940503 │   0.0780044939116137 │             0.0 │  0.004760985210671659 │  0.009266591344213428 │                   0.0 │  0.06450390165727427 │                   0.0 │ 0.052188841352289954 │  0.001997716352637136 │ 0.047960980065082925 │              0.0 │
│ Argentina │ 2017-01-08 │  0.1764949706405453 │  0.05104335092428954 │ 0.009724166262825544 │  0.08011516764004384 │  0.04601241007579796 │  0.32935390222980043 │   0.3716881660083968 │ 0.031055587398188988 │  0.18436539193439958 │  0.07781582103682504 │             0.0 │  0.004742951464212531 │  0.009724166262825544 │                   0.0 │  0.06405628918562084 │                   0.0 │  0.05050550131765247 │ 0.0020405251492572195 │  0.04656800643521855 │              0.0 │
│ Argentina │ 2017-01-09 │ 0.20798549841297484 │  0.05388657905943079 │ 0.010820579764170645 │  0.09111823711638956 │   0.0480423741842092 │  0.31952911677593765 │   0.3614863072312023 │  0.03511590793757474 │  0.20602314485397055 │  0.08365452509649358 │             0.0 │  0.005366498735413722 │  0.010820579764170645 │                   0.0 │   0.0740350982214162 │                   0.0 │ 0.058306678838621374 │  0.002370504052254147 │  0.05383113861743102 │              0.0 │
│ Argentina │ 2017-01-10 │ 0.20413622716942312 │ 0.053830106606712794 │ 0.010546706005037198 │  0.09010464284690682 │  0.04790492989694113 │  0.31786797428251484 │   0.3599096282510418 │  0.03556479714435584 │  0.20544258804283805 │  0.08404243646223976 │             0.0 │  0.005169308812483539 │  0.010546706005037198 │                   0.0 │  0.07347911052138605 │                   0.0 │ 0.056943970295765325 │ 0.0022046853634160955 │  0.05400699020933148 │              0.0 │
...
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
]

== *Dane wynikowe*

=== Obliczenia

=== Plik wynikowy

Rozmiar: \~15 MB

#[
#set text(size: 2.033pt)
```
┌───────────┬────────────┬───────────────┬──────────────────┬────────────────────┬────────────────────┬──────────────────────────────┬────────────────────┬────────────────────────┬──────────────────────────────────┬─────────────────────────────────┬─────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬───────────────────────┬───────────────────────┬───────────────────────┬──────────────────────┬──────────────────────┬───────────────────────┬──────────────────────┬───────────────────────┬──────────────────────┬────────────────────────┐
│  country  │    date    │ daily_streams │ daily_popularity │   temperature_c    │  precipitation_mm  │ wdi:rural_population_percent │ wdi:fertility_rate │ wdi:gdp_per_capita_usd │ wdi:mobile_subscriptions_per_100 │ wdi:refugee_population_promille │      genre:pop      │      genre:rap       │      genre:rock      │      genre:edm       │    genre:hip_hop     │  genre:trap_latino   │   genre:reggaeton    │   genre:electropop   │   genre:dance_pop    │    genre:pop_rap     │ genre:musica_mexicana │      genre:trap       │   genre:modern_rock   │  genre:classic_rock  │     genre:uk_pop     │      genre:k_pop      │ genre:tropical_house │   genre:melodic_rap   │  genre:canadian_pop  │ genre:modern_bollywood │
│  varchar  │    date    │    double     │     varchar      │       double       │       double       │            double            │       double       │         double         │              double              │             double              │       double        │        double        │        double        │        double        │        double        │        double        │        double        │        double        │        double        │        double        │        double         │        double         │        double         │        double        │        double        │        double         │        double        │        double         │        double        │         double         │
├───────────┼────────────┼───────────────┼──────────────────┼────────────────────┼────────────────────┼──────────────────────────────┼────────────────────┼────────────────────────┼──────────────────────────────────┼─────────────────────────────────┼─────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼───────────────────────┼───────────────────────┼───────────────────────┼──────────────────────┼──────────────────────┼───────────────────────┼──────────────────────┼───────────────────────┼──────────────────────┼────────────────────────┤
│ Argentina │ 2017-01-01 │     7888872.0 │ AVERAGE          │ 26.084999999999997 │ 10.999999999999998 │                        8.251 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │  0.1384666908019296 │ 0.051484166557652346 │ 0.007376720017766798 │  0.06322564239855838 │  0.04874866774362672 │   0.3246990190739563 │  0.36262167772528187 │ 0.020517381952705027 │  0.18184298084694492 │  0.07672516425668968 │                   0.0 │  0.005835054745469314 │  0.007376720017766798 │                  0.0 │ 0.034546637339279936 │                   0.0 │  0.03644513436141441 │                   0.0 │  0.05089244698101326 │                    0.0 │
│ Argentina │ 2017-01-02 │     6010041.0 │ LOW              │ 24.639999999999993 │  12.97142857142857 │                        8.251 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │ 0.18638558372563516 │  0.05834436071234789 │ 0.010862488292509152 │  0.07873140965261302 │  0.05423141040135999 │   0.3391201490971526 │   0.3769212223344233 │ 0.029212612692658835 │  0.19835072672549156 │  0.08281940173120284 │                   0.0 │  0.009895107204759501 │  0.010862488292509152 │                  0.0 │  0.05462475214395376 │                   0.0 │  0.04746689748039989 │  0.002404975273879163 │   0.0626860948203182 │                    0.0 │
│ Argentina │ 2017-01-03 │     5921907.0 │ LOW              │             25.345 │  4.255555555555556 │                        8.251 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │  0.1899908255904728 │  0.05795345992431154 │  0.01096386687599113 │  0.08204688118202465 │  0.05344190646695397 │   0.3345260234583218 │  0.37418183027865853 │  0.03235849532929173 │  0.20001715663552297 │    0.083363855595841 │                   0.0 │  0.009936157389840806 │   0.01096386687599113 │                  0.0 │  0.05853975754769536 │                   0.0 │  0.05097226282006793 │ 0.0023752483786050674 │  0.06182315933026304 │                    0.0 │
│ Argentina │ 2017-01-04 │     6019573.0 │ LOW              │             23.425 │ 7.1499999999999995 │            8.251000000000001 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │  0.1952096934450334 │ 0.058645687991490426 │ 0.010566197967862505 │   0.0858989499753554 │  0.05291754082889268 │   0.3312545590858355 │  0.36892699864259476 │  0.03642750075462163 │   0.2101866693866824 │  0.08425647467021331 │                   0.0 │  0.008490303215859332 │  0.010566197967862505 │                  0.0 │  0.05752019287746822 │                   0.0 │  0.05487365964330028 │ 0.0023039840201290024 │  0.05960240036959432 │                    0.0 │
│ Argentina │ 2017-01-05 │     6223646.0 │ LOW              │  20.92105263157895 │ 11.799999999999999 │            8.250999999999998 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789456 │ 0.19264463306556961 │ 0.057928423306852606 │ 0.010692285518810036 │  0.08808743299345753 │  0.05084029522244678 │   0.3277787650518683 │  0.36997380635081106 │  0.03493948723947345 │   0.2101435396550511 │  0.08537085817541679 │                   0.0 │  0.007787718003241187 │  0.010692285518810036 │                  0.0 │  0.05824029837172615 │                   0.0 │  0.05604817497653305 │ 0.0022702126695509353 │  0.05604126584320509 │                    0.0 │
│ Argentina │ 2017-01-06 │     6485179.0 │ LOW              │ 22.464999999999996 │  8.487499999999999 │                        8.251 │ 2.1679999999999997 │     14613.041824657997 │                      140.5014607 │             0.07565022812789456 │  0.2036976928470286 │  0.05591965927231924 │ 0.010243510626306537 │  0.08765617726203086 │  0.04890104035678892 │   0.3250375972660122 │  0.36745153834612737 │  0.03336345843345265 │  0.20306023935499698 │  0.08275854837622831 │                   0.0 │  0.007227865260157044 │  0.010243510626306537 │                  0.0 │   0.0730962090637745 │                   0.0 │  0.05630916278486685 │ 0.0022469695901994376 │  0.05374901756759528 │                    0.0 │
│ Argentina │ 2017-01-07 │     6840811.0 │ LOW              │ 25.009999999999998 │ 0.9555555555555555 │                        8.251 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │  0.1789156285709399 │  0.05188419911031017 │ 0.009266591344213428 │  0.08203764144339026 │ 0.046658649098769135 │   0.3253378875691786 │   0.3641291946232691 │ 0.032032897853777866 │  0.19104269946940503 │   0.0780044939116137 │                   0.0 │  0.004760985210671659 │  0.009266591344213428 │                  0.0 │  0.06450390165727427 │                   0.0 │ 0.052188841352289954 │  0.001997716352637136 │ 0.047960980065082925 │                    0.0 │
│ Argentina │ 2017-01-08 │     5691182.0 │ VERY LOW         │             24.745 │ 13.377777777777778 │                        8.251 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │  0.1764949706405453 │  0.05104335092428954 │ 0.009724166262825544 │  0.08011516764004384 │  0.04601241007579796 │  0.32935390222980043 │   0.3716881660083968 │ 0.031055587398188988 │  0.18436539193439958 │  0.07781582103682504 │                   0.0 │  0.004742951464212531 │  0.009724166262825544 │                  0.0 │  0.06405628918562084 │                   0.0 │  0.05050550131765247 │ 0.0020405251492572195 │  0.04656800643521855 │                    0.0 │
│ Argentina │ 2017-01-09 │     5880184.0 │ LOW              │ 24.889999999999993 │  3.023076923076923 │                        8.251 │              2.168 │     14613.041824657997 │                      140.5014607 │             0.07565022812789457 │ 0.20798549841297484 │  0.05388657905943079 │ 0.010820579764170645 │  0.09111823711638956 │   0.0480423741842092 │  0.31952911677593765 │   0.3614863072312023 │  0.03511590793757474 │  0.20602314485397055 │  0.08365452509649358 │                   0.0 │  0.005366498735413722 │  0.010820579764170645 │                  0.0 │   0.0740350982214162 │                   0.0 │ 0.058306678838621374 │  0.002370504052254147 │  0.05383113861743102 │                    0.0 │
│ Argentina │ 2017-01-10 │     5896533.0 │ LOW              │ 21.494736842105258 │               15.6 │                        8.251 │              2.168 │        14613.041824658 │                      140.5014607 │             0.07565022812789457 │ 0.20413622716942312 │ 0.053830106606712794 │ 0.010546706005037198 │  0.09010464284690682 │  0.04790492989694113 │  0.31786797428251484 │   0.3599096282510418 │  0.03556479714435584 │  0.20544258804283805 │  0.08404243646223976 │                   0.0 │  0.005169308812483539 │  0.010546706005037198 │                  0.0 │  0.07347911052138605 │                   0.0 │ 0.056943970295765325 │ 0.0022046853634160955 │  0.05400699020933148 │                    0.0 │
...
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
]
